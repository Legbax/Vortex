## 2024-05-22 - File.exists Hook Optimization Flaw **Learning:** The manual 'contains' check in hookFile was a premature optimization that bypassed SpoofingUtils logic for sensitive paths lacking specific keywords (e.g. /data/adb/modules/test). This created a detection vulnerability on Lancelot where direct file checks could succeed. **Action:** Always delegate full path checking to centralized SpoofingUtils which uses optimized sets/prefixes. Avoid inline string scanning optimizations that reduce coverage.
